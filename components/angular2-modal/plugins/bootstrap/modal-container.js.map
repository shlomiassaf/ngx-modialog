{"version":3,"file":"modal-container.js","sourceRoot":"","sources":["modal-container.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  ComponentFactoryResolver,\n  ViewContainerRef,\n  ViewChild,\n  ViewEncapsulation,\n  AfterViewInit,\n  ElementRef,\n  trigger,\n  state,\n  style,\n  keyframes,\n  animate,\n  transition\n} from '@angular/core';\n\nimport { createComponent, DialogRef, ModalCompileConfig } from '../../angular2-modal';\n\nimport { Modal } from './modal';\nimport { supportsKey } from '../../framework/utils';\nimport { BSModalContext } from './modal-context';\n\n/**\n * A component that acts as a top level container for an open modal window.\n */\n@Component({\n  selector: 'modal-container',\n  host: {\n    'tabindex': '-1',\n    'role': 'dialog',\n    'class': 'modal',\n    'style': 'display: block',\n    '[style.position]': 'position',\n    '(body:keydown)': 'documentKeypress($event)'\n  },\n  animations: [\n    trigger('fade', [\n      transition('void => in', [\n        animate('100ms linear', keyframes([\n          style({ opacity: 0, transform: 'translate(0, -25%)' }),\n          style({ opacity: 0, transform: 'translate(0, -25%)' })\n        ])),\n        animate('300ms linear', keyframes([\n          style({ opacity: 0, transform: 'translate(0, -25%)', offset: 0 }),\n          style({ opacity: 1, transform: 'translate(0, -12.5%)', offset: 0.5 }),\n          style({ opacity: 1, transform: 'translate(0, 0)', offset: 1 })\n        ]))\n      ]),\n      state('out',  style({ opacity: 0, transform: 'translate(0, -25%)'} )),\n      transition('in => out', [\n        animate('150ms linear', keyframes([\n          style({ opacity: 1, transform: 'translate(0, 0)' }),\n          style({ opacity: 0, transform: 'translate(0, -12.5%)' }),\n        ]))\n      ])\n    ])\n  ],\n  encapsulation: ViewEncapsulation.None,\n  /* tslint:disable */\n  template: `<div [ngClass]=\"dialog.context.dialogClass\" \n          [class.modal-lg]=\"dialog.context.size == \\'lg\\'\"\n          [class.modal-sm]=\"dialog.context.size == \\'sm\\'\"\n          [@fade]=\"fadeState\">\n         <div class=\"modal-content\"              \n              style=\"display:block\"              \n              role=\"document\"\n              (clickOutside)=\"onClickOutside()\">\n            <div style=\"display: none\" #modalDialog></div>\n         </div>\n    </div>`\n  /* tslint:enable */\n})\nexport class BSModalContainer implements AfterViewInit {\n  public position: string;\n\n  fadeState: 'in' | 'out' = 'in';\n\n  @ViewChild('modalDialog', {read: ViewContainerRef}) private _viewContainer: ViewContainerRef;\n\n  constructor(public dialog: DialogRef<BSModalContext>,\n              private el: ElementRef,\n              private _compileConfig: ModalCompileConfig,\n              private _modal: Modal,\n              private _cr: ComponentFactoryResolver) {\n    if (!dialog.inElement) {\n      this.position = null;\n    } else {\n      this.position = 'absolute';\n    }\n    dialog.onDestroy.subscribe(() => this.fadeState = 'out');\n  }\n\n  ngAfterViewInit() {\n    if (this.el.nativeElement) {\n      this.el.nativeElement.focus();\n    }\n\n    /*  TODO:\n        In RC5 dynamic component creation is no longer async.\n        Somewhere down the pipe of the created component a value change happens that fires\n        a CD exception. setTimeout is a workaround that mimics the async behavior.\n        Find out the error and remove setTimeout.\n     */\n    setTimeout( () => {\n      this.dialog.contentRef = createComponent(\n        this._cr,\n        this._compileConfig.component,\n        this._viewContainer,\n        this._compileConfig.bindings);\n    });\n  }\n\n  onClickOutside() {\n    if (this._modal.isTopMost(this.dialog) && !this.dialog.context.isBlocking)\n      this.dialog.dismiss();\n  }\n\n  documentKeypress(event: KeyboardEvent) {\n    // check that this modal is the last in the stack.\n    if (!this._modal.isTopMost(this.dialog)) return;\n\n\n    if (supportsKey(event.keyCode, <any>this.dialog.context.keyboard)) {\n      this.dialog.dismiss();\n    }\n  }\n}\n"]}